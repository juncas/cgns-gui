# 开发计划

## 概述

本文档跟踪 CGNS GUI 项目的开发阶段、任务分解与验收标准。项目目标为构建一个使用 PySide6 + VTK 的 CGNS 网格可视化工具，支持 Section 级别的选取与高亮。

## 时间线（建议）

- **第 1 周**：M0 ~ M1
  - 项目基础结构、依赖配置、最小运行窗口。
  - CGNS 文件解析模块原型，成功读取样例文件结构。
- **第 2 周**：M2 ~ M3
  - 建立 VTK 渲染管线，能绘制 Zone/Section 网格。
  - 实现拾取与高亮逻辑，UI 与渲染联动。
- **第 3 周**：M4 ~ M5
  - 完善交互体验（视角控制、自定义设置）。
  - 优化 UI，增加状态反馈与错误处理。
- **第 4 周**：M6
  - 编写测试用例、集成 CI。
  - 打包与发布准备，撰写使用指南与 FAQ。
- **第 5 周**：M7
  - 完成 Windows 等跨平台环境调研与依赖确认。
  - 建立 Windows CI 与安装脚本，验证构建流程。
- **第 6 周**：M8
  - 针对缩放后的平移效率、旋转重心等渲染交互问题进行优化。
  - 固定坐标显示组件，确保窗口缩放时稳定可见。
- **第 7 周**：M9
  - 扩展 CGNS 解析以加载流场等数据集。
  - 设计数据模型与 UI，支撑云图、切片等可视化需求。
- **第 8 周**：M10
  - 调整渲染模式逻辑，确保 Surface 模式不再叠加线框。
  - 组织文档与示例，准备阶段性回归测试。

## 里程碑拆解

### M0：项目基线
- [x] `pyproject.toml`、`README`、`src` 结构就绪。
- [x] 配置代码格式与质量工具（Ruff、Pytest）。
- [x] PySide6 + VTK 最小可运行窗口。

### M1：CGNS 数据加载
- [x] 设计数据模型（Zone / Section / MeshData）。
- [x] 实现 `CgnsLoader`，支持读取 HDF5 格式 CGNS。
- [x] 提供单元测试覆盖基本解析逻辑。
- [x] UI 中展示 CGNS 树状结构。

### M2：网格渲染
- [x] 构建 `SceneManager` 与 VTK 渲染管线。
- [x] Section 网格转换为 VTK 数据源 Actor。
- [x] 支持线框/表面模式切换。

### M3：选取与高亮
- [x] 整合 `SelectionController`，利用 VTK 拾取器定位 Section。
- [x] 实现高亮效果（颜色/轮廓/透明度）。
- [x] UI 属性面板展示 Section 信息。

### M4：视角交互
- [x] 鼠标左键旋转、右键缩放、中键平移。
- [x] 添加重置视角、坐标轴指南。
- [x] 设计可扩展的交互事件系统。

### M5：体验增强
- [x] 状态栏、加载进度指示。
- [x] 异常捕获与用户提示对话框。
- [x] 设置面板（背景色、渲染模式等）。

### M6：测试与交付
- [x] 解析与渲染模块的单元/集成测试。
- [x] 集成 CI 流程（GitHub Actions）。
- [x] 打包脚本（PyInstaller 或 `python -m build`）及发布指南。

### M7：跨平台支持
- [x] 调研 PySide6、VTK、CGNS 在 Windows 上的依赖与安装方式。
- [x] 建立 Windows CI workflow，保证 lint、pytest、打包在 windows-latest 上通过。
- [x] 补充 Windows 开发与运行指南，涵盖环境搭建、常见问题。
- [x] 更新打包脚本与发布流程，使 wheel/安装程序在 Windows 上可用。

### M8：渲染交互优化
- [x] 自定义或调整 VTK interactor，解决缩放后平移缓慢的问题。
- [x] 在可见几何体基础上动态更新旋转重心，保持操作稳定。
- [ ] 固定坐标显示组件（轴向指示），无论窗口大小或场景变化均保持可见。
- [x] 为上述改动补充交互层单测或演示脚本，并更新文档。

### M9：流场数据加载与可视化
- [ ] 扩展 `CgnsLoader` 支持 `FlowSolution_t` 等常见流场节点与标量/矢量场。
- [ ] 新增模型层抽象（如 `FlowField`），并与 Zone/Section 建立关联。
- [ ] 在 UI 中提供字段选择、颜色表设定、取值范围等配置入口。
- [ ] 实现云图、等值面、切片等可视化路径，并针对大数据量评估性能。
- [ ] 为新解析逻辑与可视化管线编写单元/集成测试及示例文件说明。

### M10：渲染模式细化与回归
- [ ] 调整 Surface 模式行为，在非必要场景下隐藏 wireframe。
- [ ] 梳理渲染设置面板，避免模式切换造成状态不一致。
- [ ] 组织跨平台回归测试（Linux/Windows），覆盖核心交互与新功能。
- [ ] 更新 README、release guide、开发日志，记录新功能与使用方式。

## 任务跟踪表

| 编号 | 任务 | 所属里程碑 | 优先级 | 状态 | 负责人 |
| --- | --- | --- | --- | --- | --- |
| T-001 | 初始化项目结构 | M0 | ⭐⭐⭐ | 已完成 | - |
| T-002 | 配置依赖与工具 | M0 | ⭐⭐⭐ | 已完成 | - |
| T-003 | 创建最小窗口 Demo | M0 | ⭐⭐ | 已完成 | - |
| T-004 | 设计数据模型 | M1 | ⭐⭐⭐ | 已完成 | - |
| T-005 | 实现 CGNS 解析 | M1 | ⭐⭐⭐ | 已完成 | - |
| T-006 | 构建渲染管线 | M2 | ⭐⭐⭐ | 已完成 | - |
| T-007 | Section 高亮逻辑 | M3 | ⭐⭐⭐ | 已完成 | - |
| T-008 | 视角交互增强 | M4 | ⭐⭐ | 已完成 | - |
| T-009 | UX 与错误处理 | M5 | ⭐⭐ | 已完成 | - |
| T-010 | 测试与 CI | M6 | ⭐⭐⭐ | 已完成 | - |
| T-011 | 打包与文档 | M6 | ⭐⭐ | 已完成 | - |
| T-012 | Windows 依赖调研与环境指南（见 `docs/windows-setup.md`） | M7 | ⭐⭐⭐ | 已完成 | - |
| T-013 | Windows CI 与打包验证（GitHub Actions `windows-latest`） | M7 | ⭐⭐⭐ | 已完成 | - |
| T-014 | 渲染交互性能优化 | M8 | ⭐⭐ | 已完成 | - |
| T-015 | 坐标显示固定化 | M8 | ⭐⭐ | 未开始 | - |
| T-016 | 流场数据解析扩展 | M9 | ⭐⭐⭐ | 未开始 | - |
| T-017 | 云图/切片可视化实现 | M9 | ⭐⭐⭐ | 未开始 | - |
| T-018 | Surface 模式线框策略调整 | M10 | ⭐⭐ | 未开始 | - |
| T-019 | 跨平台回归测试与文档更新 | M10 | ⭐⭐⭐ | 未开始 | - |

> 提示：可在后续阶段将“负责人”与“状态”字段用于日常推进记录。

## 后续文档

- `docs/architecture.md`：模块设计图与数据流说明（待编写）。
- `docs/testing-strategy.md`：测试用例设计与样例文件说明（待编写）。

## 依赖与资源

- CGNS 标准文档与样例文件。 
- PySide6 官方文档、VTK Qt 交互指南。 
- Python HDF5 与 CGNS 解析资料。

## 执行约定

- 每项新功能或优化需严格遵循“实现 → 单元/集成测试 → 文档记录 → 审核 → 提交”的流程。
- 在功能获得审核通过前，不进行 Git 提交；提交时需确保 CI 通过且文档最新。
- 开发日志应同步记录关键设计思路、测试覆盖与潜在风险，便于后续追溯。

---

如需调整时间表或优先级，请更新表格并同步团队成员。